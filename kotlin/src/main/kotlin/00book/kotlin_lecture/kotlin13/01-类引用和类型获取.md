# Kotlin åå°„ - ç±»å¼•ç”¨å’Œç±»å‹è·å–

## ğŸ“š ä»€ä¹ˆæ˜¯åå°„ï¼Ÿ

åå°„ï¼ˆReflectionï¼‰æ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥ã€è®¿é—®å’Œä¿®æ”¹è‡ªèº«ç»“æ„å’Œè¡Œä¸ºçš„èƒ½åŠ›ã€‚é€šè¿‡åå°„ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
- åœ¨è¿è¡Œæ—¶è·å–ç±»çš„ä¿¡æ¯ï¼ˆç±»åã€å±æ€§ã€æ–¹æ³•ç­‰ï¼‰
- åŠ¨æ€è°ƒç”¨æ–¹æ³•å’Œè®¿é—®å±æ€§
- åˆ›å»ºå¯¹è±¡å®ä¾‹
- æ£€æŸ¥ç±»å‹ä¿¡æ¯

---

## 1. è·å–ç±»å¼•ç”¨ï¼ˆKClass vs Java Classï¼‰

### ç¤ºä¾‹ä»£ç ï¼šHelloKotlin1.kt

```kotlin
fun main(args: Array<String>) {
    val c = String::class        // è·å– Kotlin çš„ KClass
    println(c)                   // è¾“å‡ºï¼šclass kotlin.String

    println("-------")

    val c2 = String::class.java  // è·å– Java çš„ Class
    println(c2)                  // è¾“å‡ºï¼šclass java.lang.String
}
```

**çŸ¥è¯†ç‚¹ï¼š**
- `::class` è·å– Kotlin çš„ KClass ç±»å‹
- `::class.java` è·å– Java çš„ Class ç±»å‹
- KClass æ˜¯ Kotlin å¯¹åå°„çš„å°è£…ï¼Œæä¾›æ›´å¤š Kotlin ç‰¹æ€§æ”¯æŒ

---

## 2. è¿è¡Œæ—¶ç±»å‹åˆ¤æ–­

### ç¤ºä¾‹ä»£ç ï¼šHelloKotlin2.kt

```kotlin
fun main(args: Array<String>) {
    val son: Parent = Son()           // å£°æ˜ç±»å‹æ˜¯ Parent
    val daughter: Parent = Daughter() // å£°æ˜ç±»å‹æ˜¯ Parent

    println(son::class)               // è¾“å‡ºï¼šclass Sonï¼ˆå®é™…ç±»å‹ï¼‰
    println(son::class.java)          // è¾“å‡ºï¼šclass Son

    println("---------")

    println(daughter::class)          // è¾“å‡ºï¼šclass Daughterï¼ˆå®é™…ç±»å‹ï¼‰
    println(daughter::class.java)     // è¾“å‡ºï¼šclass Daughter
}

open class Parent
class Son: Parent()
class Daughter: Parent()
```

**çŸ¥è¯†ç‚¹ï¼š**
- `::class` è·å–çš„æ˜¯å¯¹è±¡çš„**å®é™…è¿è¡Œæ—¶ç±»å‹**ï¼Œè€Œä¸æ˜¯å£°æ˜ç±»å‹
- å³ä½¿å˜é‡å£°æ˜ä¸ºçˆ¶ç±»å‹ï¼Œåå°„ä¹Ÿèƒ½è·å–çœŸå®çš„å­ç±»ç±»å‹
- è¿™åœ¨å¤šæ€åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨

---

## 3. KClass è¯¦è§£

### ç¤ºä¾‹ä»£ç ï¼šHelloKotlin11.kt

```kotlin
fun main(args: Array<String>) {
    val kotlinLang = "kotlin"
    val kclass: KClass<out String> = kotlinLang::class
    println(kclass)  // è¾“å‡ºï¼šclass kotlin.String

    println("------------")

    val kclassDataType: KClass<String> = String::class
    println(kclassDataType)  // è¾“å‡ºï¼šclass kotlin.String

    println("------------")

    // ä¸åŒå­—ç¬¦ä¸²å¯¹è±¡çš„ KClass æ˜¯ç›¸åŒçš„
    val kclass1: KClass<out String> = "kotlin"::class
    val kclass2: KClass<out String> = "java"::class
    val kclass3: KClass<out String> = "ruby"::class

    println(kclass1)  // è¾“å‡ºï¼šclass kotlin.String
    println(kclass2)  // è¾“å‡ºï¼šclass kotlin.String
    println(kclass3)  // è¾“å‡ºï¼šclass kotlin.String
    println(kclass1 == kclass2)  // è¾“å‡ºï¼štrueï¼ˆç±»å‹ç›¸åŒï¼‰

    println("------------")

    // é€šè¿‡ Java Class è·å– KClass
    val kclass4 = Class.forName("java.util.Date").kotlin
    println(kclass4)  // è¾“å‡ºï¼šclass java.util.Date

    println(kclass4 == Class.forName("java.util.Date"))  // falseï¼ˆç±»å‹ä¸åŒï¼‰
    println(kclass4 == Class.forName("java.util.Date").kotlin)  // true
}
```

**çŸ¥è¯†ç‚¹ï¼š**
- åŒä¸€ç±»å‹çš„ä¸åŒå¯¹è±¡ï¼Œå®ƒä»¬çš„ KClass æ˜¯ç›¸åŒçš„
- `KClass<out String>` è¡¨ç¤º String æˆ–å…¶å­ç±»çš„ KClass
- å¯ä»¥é€šè¿‡ `Class.forName().kotlin` å°† Java Class è½¬æ¢ä¸º KClass
- KClass å’Œ Java Class æ˜¯ä¸åŒçš„ç±»å‹ï¼Œéœ€è¦æ³¨æ„æ¯”è¾ƒ

---

## 4. Kotlin ä¸ Java äº’æ“ä½œ

### ç¤ºä¾‹ä»£ç ï¼šHelloKotlin8.kt

```kotlin
class T(val x: Int)

fun main(args: Array<String>) {
    println(T::x.javaGetter)  // è¾“å‡ºï¼špublic final int T.getX()
    println(T::x.javaField)   // è¾“å‡ºï¼šprivate final int T.x

    println("---------")

    println(T(10).javaClass)         // è¾“å‡ºï¼šclass T
    println(T(10).javaClass.kotlin)  // è¾“å‡ºï¼šclass Tï¼ˆè½¬å› KClassï¼‰

    println(String.javaClass)        // è¾“å‡ºï¼šclass java.lang.String
    println(String.javaClass.kotlin) // è¾“å‡ºï¼šclass kotlin.String
}
```

**çŸ¥è¯†ç‚¹ï¼š**
- `javaGetter` è·å– Java çš„ getter æ–¹æ³•
- `javaField` è·å– Java çš„å­—æ®µ
- `javaClass` è·å– Java Class å¯¹è±¡
- `.kotlin` å°† Java Class è½¬æ¢ä¸º Kotlin KClass
- Kotlin å±æ€§åœ¨ Java ä¸­ä¼šç”Ÿæˆå¯¹åº”çš„å­—æ®µå’Œ getter/setter æ–¹æ³•

---

## ğŸ’¡ æ€»ç»“

1. **KClass vs Java Class**ï¼šKClass æ˜¯ Kotlin çš„åå°„ç±»å‹ï¼ŒJava Class æ˜¯ Java çš„åå°„ç±»å‹
2. **è·å–æ–¹å¼**ï¼š`::class` è·å– KClassï¼Œ`::class.java` è·å– Java Class
3. **è¿è¡Œæ—¶ç±»å‹**ï¼šåå°„è·å–çš„æ˜¯å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œä¸æ˜¯å£°æ˜ç±»å‹
4. **äº’æ“ä½œ**ï¼šå¯ä»¥é€šè¿‡ `.kotlin` å’Œ `.java` åœ¨ä¸¤ç§ç±»å‹ä¹‹é—´è½¬æ¢
