# Kotlin 反射机制完整教程 - 目录索引

## 📚 教程概述

本教程系统地介绍了 Kotlin 反射机制的各个方面，从基础的类引用到高级的动态调用和对象创建。每个文档都包含详细的代码示例、知识点讲解和实际应用场景。

---

## 📖 教程目录

### [01-类引用和类型获取.md](./01-类引用和类型获取.md)
**核心内容：**
- 什么是反射
- KClass vs Java Class 的区别
- 获取类引用的方法（`::class` 和 `::class.java`）
- 运行时类型判断
- KClass 详解
- Kotlin 与 Java 互操作

**对应代码文件：**
- HelloKotlin1.kt - 基本类引用
- HelloKotlin2.kt - 运行时类型判断
- HelloKotlin8.kt - Java 互操作
- HelloKotlin11.kt - KClass 详解

**适合人群：** 反射初学者，需要了解基础概念

---

### [02-函数引用.md](./02-函数引用.md)
**核心内容：**
- 函数引用的基本语法（`::函数名`）
- 函数重载的引用
- 函数组合（Function Composition）
- 构造方法引用
- 特定对象的方法引用

**对应代码文件：**
- HelloKotlin3.kt - 基本函数引用和重载
- HelloKotlin4.kt - 函数组合
- HelloKotlin9.kt - 构造方法引用
- HelloKotlin10.kt - 特定对象的方法引用

**适合人群：** 了解函数式编程，想深入理解函数引用

---

### [03-属性引用.md](./03-属性引用.md)
**核心内容：**
- 顶层属性引用
- 类成员属性引用
- 扩展属性引用
- KProperty vs KMutableProperty
- 属性的 Java 互操作（javaField、javaGetter、javaSetter）

**对应代码文件：**
- HelloKotlin5.kt - 顶层属性引用
- HelloKotlin6.kt - 类成员属性引用
- HelloKotlin7.kt - 扩展属性引用
- HelloKotlin25.kt - 属性的详细操作
- HelloKotlin26.kt - 属性的 Java 互操作

**适合人群：** 需要动态访问和修改属性的开发者

---

### [04-类信息获取.md](./04-类信息获取.md)
**核心内容：**
- 获取泛型类型参数
- 获取父类和接口
- 获取成员属性列表
- 获取成员方法列表
- 获取构造函数列表
- 获取伴生对象（Companion Object）

**对应代码文件：**
- HelloKotlin12.kt - 泛型类型参数
- HelloKotlin13.kt - 父类和接口
- HelloKotlin14.kt - 成员属性列表
- HelloKotlin15.kt - 成员方法列表
- HelloKotlin16.kt - 构造函数列表
- HelloKotlin20.kt - 伴生对象

**适合人群：** 框架开发者，需要获取类的元数据信息

---

### [05-动态调用方法和属性.md](./05-动态调用方法和属性.md)
**核心内容：**
- 动态调用方法（`call()`）
- 动态访问属性（`get()`）
- 动态修改属性（`setter.call()`）
- 处理方法重载
- 类型安全的属性修改（KMutableProperty1）

**对应代码文件：**
- HelloKotlin17.kt - 动态调用方法
- HelloKotlin18.kt - 动态访问属性
- HelloKotlin19.kt - 动态修改属性
- HelloKotlin23.kt - 动态调用重载方法
- HelloKotlin24.kt - 类型安全的属性修改

**适合人群：** 需要实现动态行为的高级开发者

---

### [06-动态创建对象.md](./06-动态创建对象.md)
**核心内容：**
- 使用无参构造函数创建对象（`createInstance()`）
- 使用特定构造函数创建对象
- 完整的对象创建和操作流程
- 实际应用：通用对象工厂

**对应代码文件：**
- HelloKotlin21.kt - 无参构造函数创建对象
- HelloKotlin22.kt - 特定构造函数创建对象
- HelloKotlin23.kt - 完整流程示例
- HelloKotlin24.kt - 创建对象并操作属性

**适合人群：** 框架开发者，需要实现依赖注入、对象池等功能

---

## 🎯 学习路径建议

### 初学者路径
1. 先阅读 **01-类引用和类型获取**，理解反射的基本概念
2. 然后学习 **02-函数引用** 和 **03-属性引用**，掌握引用的使用
3. 最后学习 **04-类信息获取**，了解如何获取类的元数据

### 进阶路径
1. 在掌握基础后，学习 **05-动态调用方法和属性**
2. 最后学习 **06-动态创建对象**，实现完整的反射应用

### 实战路径
按照实际需求选择对应章节：
- 需要动态调用方法 → 02、05
- 需要动态访问属性 → 03、05
- 需要创建对象 → 06
- 需要获取类信息 → 04

---

## 🔑 核心 API 速查

### 获取类引用
```kotlin
String::class              // KClass
String::class.java         // Java Class
对象::class                // 运行时类型
```

### 函数和属性引用
```kotlin
::函数名                   // 函数引用
::属性名                   // 属性引用
类名::成员                 // 类成员引用
对象::成员                 // 绑定引用
```

### 获取类信息
```kotlin
kclass.typeParameters      // 泛型参数
kclass.superclasses        // 父类和接口
kclass.memberProperties    // 成员属性
kclass.memberFunctions     // 成员方法
kclass.constructors        // 构造函数
kclass.companionObject     // 伴生对象
```

### 动态调用
```kotlin
function.call(instance, args...)    // 调用方法
property.get(instance)              // 获取属性
mutableProperty.setter.call(...)    // 修改属性
kclass.createInstance()             // 创建对象
```

---

## 📦 需要导入的包

大部分反射功能需要导入 `kotlin.reflect.full` 包：

```kotlin
import kotlin.reflect.full.createInstance
import kotlin.reflect.full.memberProperties
import kotlin.reflect.full.memberFunctions
import kotlin.reflect.full.declaredFunctions
import kotlin.reflect.full.declaredMemberProperties
import kotlin.reflect.full.superclasses
import kotlin.reflect.full.companionObject
import kotlin.reflect.jvm.javaField
import kotlin.reflect.jvm.javaGetter
import kotlin.reflect.jvm.javaSetter
```

---

## 💡 实际应用场景

1. **依赖注入框架**（如 Koin、Dagger）
2. **序列化/反序列化**（如 Gson、Jackson）
3. **ORM 框架**（如 Exposed、Room）
4. **单元测试框架**（如 JUnit、Mockito）
5. **插件系统**
6. **动态代理**
7. **配置驱动的应用**
8. **注解处理器**

---

## ⚠️ 注意事项

1. **性能影响**：反射比直接调用慢，避免在性能敏感的代码中频繁使用
2. **类型安全**：反射绕过了编译时类型检查，需要小心处理类型转换
3. **异常处理**：反射操作可能抛出异常，需要适当处理
4. **混淆问题**：使用 ProGuard/R8 时需要保留反射使用的类和成员
5. **依赖**：需要添加 `kotlin-reflect` 依赖

---

## 📝 总结

Kotlin 反射机制提供了强大的运行时元编程能力，通过本教程的学习，你将掌握：
- ✅ 如何获取和使用类、函数、属性的引用
- ✅ 如何在运行时获取类的元数据信息
- ✅ 如何动态调用方法和访问属性
- ✅ 如何动态创建对象
- ✅ 反射在实际项目中的应用场景

建议结合代码示例进行实践，加深理解！
